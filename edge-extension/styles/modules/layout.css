/**
 * layout.css - 布局、响应式、面板过渡动画
 * 包含：设置模式、输入区过渡、调整器、移动端适配、面板动画、底部Sheet
 */

/* ========================================
   Settings Mode
   ======================================== */

body.settings-mode #chat-stream,
body.settings-mode #input-area {
    display: none;
}

body.settings-mode #settings-view {
    display: flex;
}

/* ========================================
   Input Area Transitions
   ======================================== */

#input-area {
    transition: transform var(--ido-transition-base), opacity var(--ido-transition-base), max-height var(--ido-transition-base);
    transform-origin: bottom;
}

/* Hidden state for input area when certain modes want to hide it without changing layout logic */
#input-area.ido-input-area--hidden {
    transform: translateY(20px);
    opacity: 0;
    max-height: 0;
    overflow: hidden;
    pointer-events: none;
}

/* ========================================
   Resizer Handles
   ======================================== */

.resizer {
    width: 4px;
    cursor: col-resize;
    background-color: transparent;
    transition: background-color 0.2s;
    z-index: 50;
    flex-shrink: 0;
}

.resizer:hover, .resizer.active {
    background-color: #3b82f6; /* Blue-500 */
}

/* Transitions */
/* We only apply transitions when NOT dragging to ensure smooth toggling */
.transition-width {
    transition: width 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Prevent text selection during drag */
body.is-resizing {
    user-select: none;
    cursor: col-resize;
}

/* ========================================
   Mobile Overlay Behavior
   ======================================== */

@media (max-width: 768px) {
    #left-panel {
        position: absolute;
        height: 100%;
        z-index: 40;
        box-shadow: 4px 0 24px rgba(0,0,0,0.1);
    }
    #right-panel {
        position: absolute;
        right: 0;
        height: 100%;
        z-index: 40;
        box-shadow: -4px 0 24px rgba(0,0,0,0.1);
    }
    /* Hide resizers on mobile */
    .resizer { display: none; }
    
    /* 拖动状态：禁用过渡动画实现跟手效果 */
    #left-panel.ido-panel--dragging,
    #right-panel.ido-panel--dragging {
        transition: none !important;
    }
    
    /* 拖动时的遮罩层也禁用过渡 */
    #backdrop.ido-backdrop--dragging {
        transition: none !important;
    }
}

/* ========================================
   Bottom Sheet (Drawer) Transitions
   ======================================== */

#bottom-sheet-backdrop {
    z-index: 50;
    opacity: 0;
    transition: opacity var(--ido-transition-base);
}

#bottom-sheet-backdrop.ido-bottom-sheet-backdrop--visible {
    opacity: 1;
}

#bottom-sheet {
    z-index: 51;
    transform: translateY(100%);
    transition: transform var(--ido-transition-base);
}

#bottom-sheet.ido-bottom-sheet--visible {
    transform: translateY(0);
}

/* Default bottom sheet content height */
#bottom-sheet-content {
    height: 80vh;
}

/* ========================================
   Panel Transition Animations
   ======================================== */

/* 面板内容切换动画 - 使用 transform 和 opacity 避免 reflow */
.panel-transition-exit {
    animation: panelExit 200ms cubic-bezier(0.4, 0, 1, 1) forwards;
}

.panel-transition-enter {
    animation: panelEnter 250ms cubic-bezier(0, 0, 0.2, 1) forwards;
}

@keyframes panelExit {
    from {
        opacity: 1;
        transform: translateX(0);
    }
    to {
        opacity: 0;
        transform: translateX(-20px);
    }
}

@keyframes panelEnter {
    from {
        opacity: 0;
        transform: translateX(20px);
    }
    to {
        opacity: 1;
        transform: translateX(0);
    }
}

/* 为动画容器添加性能优化提示 */
.panel-transition-container {
    will-change: transform, opacity;
    /* 确保容器在动画期间保持固定尺寸，避免影响父容器布局 */
    position: relative;
    width: 100%;
    height: 100%;
}

/* 尊重用户的减少动画偏好 */
@media (prefers-reduced-motion: reduce) {
    .panel-transition-exit,
    .panel-transition-enter {
        animation: none !important;
    }
    
    .panel-transition-exit {
        opacity: 0;
    }
    
    .panel-transition-enter {
        opacity: 1;
    }
}

/* ========================================
   Channel Settings - Mobile Optimization
   ======================================== */

/* 移动端隐藏渠道状态文字，仅保留切换开关和颜色区分 */
@media (max-width: 768px) {
    .channel-status-text {
        display: none !important;
    }
}